<ng-template #editMetaBookModal let-c="close" let-d="dismiss" *ngIf="lgoin==='librarian'">
  <div class="modal-header">
    <h4 class="modal-title" id="submit-modal-title">edit meta book</h4>
    <button type="button" class="close" aria-label="Close" (click)="modalService.dismissAll()">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    <div class="col-md order-md-1">
      <div class="input-group col-md-12">
        <div class="input-group-prepend">
          <span class="input-group-text">ISBN</span>
        </div>
        <input type="text" class="form-control" id="isbn"
          placeholder="Please input your isbn" disabled required
          [(ngModel)]="showMetaBook.isbn">
      </div>

      <!-- todo: finish this modal -->

      <button type="button" class="btn btn-info" (click)="submit_edit_meta_book()">add Account</button>
    </div>
  </div>
</ng-template>


<div class="app-wrapper" >
  <div *ngIf="metaBook">
    <h2> {{ metaBook.title }} </h2>
    <div class="lead">{{ metaBook.subtitle }}</div>

    <div class="detail" >
      <div class="detail-attr">
        <button class="badge badge-info">{{metaBook.author}}</button>
        <div><span>ISBN: </span>{{metaBook.isbn}}</div>
        <div><span>pages: </span>{{metaBook.pages}}</div>
        <div><span>publisher: </span> {{metaBook.publisher}}</div>
        <div><span>publish year: </span>{{metaBook.publish_year}}</div>
        <div><span>keywords: </span>{{metaBook.keyword}}</div>
      </div>

      <div class="detail-img">
        <img src="{{ metaBook.cover }}" alt="cover">
      </div>
    </div>


    <h4>Description</h4>
    <hr>
    <div id="desc_html block_quote" [innerHtml]="metaBook.desc_html"></div>
  </div>

  <br>

  <div class="alert alert-info" role="alert" *ngIf="!books">
    This book is not in Library!
  </div>

  <div class="table-responsive" *ngIf="books">
    <table class="table table-hover table-striped">
      <thead class="thead-light">
        <tr>
          <th scope="col">#</th>
          <th scope="col">Barcode</th>
          <th scope="col">Location</th>
          <th scope="col">Add Time</th>
          <th scope="col">Available</th>
          <th scope="col" *ngIf="login==='librarian'">operation</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let x of books; let i = index; first as isFirst">
          <th scope="row">{{i}}</th>
          <td>{{x.barcode}}</td>
          <td>{{x.location}}</td>
          <td>{{x.add_time}}</td>
          <td>{{x.available}}</td>
          <td *ngIf="login==='librarian'">
            <button type="button" class="btn btn-sm" placement="top" (click)="edit_location($event)" ngbTooltip="edit location">
              <i class="fa fa-edit"></i>
            </button>
            &nbsp;
            <button type="button" class="btn btn-sm" placement="top" (click)="remove_book($event)" ngbTooltip="remove this book">
              <i class="fa fa-eraser"></i>
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div id="reader_operation" *ngIf="login==='reader'">
    <button type="button" class="btn btn-info" (click)="resever_book()" [disabled]="disable_reserve()">
      reserve this book
    </button>
  </div>
  <div id="librarian_operation" *ngIf="login==='librarian'">
    <button type="button" class="btn btn-info" (click)="modalService.open(editMetaBookModal)">
      edit this meta book information
    </button>
    <button type="button" class="btn btn-danger" (click)="delete_meta_book()">
      delete this meta book (danger)
    </button>
  </div>
</div>
